package main

import (
	"flag"
	"os"
	"sort"
	"strings"
	"text/template"
)

type data struct {
	Levels []string
}

func main() {
	var d data
	var items string
	flag.StringVar(&items, "levels", "", "List of levels")
	flag.Parse()

	if items != "" {
		d.Levels = strings.Split(items, ",")
		sort.Strings(d.Levels)
	}

	t := template.Must(template.New("queue").Parse(queueTemplate))
	t.Execute(os.Stdout, d)
}

var queueTemplate = `// Code generated by gen/gen.go - DO NOT EDIT.
package timber

import (
	"fmt"
){{range .Levels}}

// {{.}} writes the provided string to the log.
func (l *logger) {{.}}(msg string) {
	l.log(l.stackDepth, {{.}}, nil, msg)
}

// {{.}}f writes a formatted string using the arguments provided to the log.
func (l *logger) {{.}}f(msg string, args ...interface{}) {
	l.log(l.stackDepth, {{.}}, nil, fmt.Sprintf(msg, args...))
}

// {{.}}Ex writes a formatted string using the arguments provided to the log
// but also will prefix the log message with they keys provided to help print
// runtime variables.
func (l *logger) {{.}}Ex(keys Keys, msg string, args ...interface{}) {
	l.log(l.stackDepth, {{.}}, keys, fmt.Sprintf(msg, args...))
}{{else}}
// No levels
{{end}}
`
